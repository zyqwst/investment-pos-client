webpackJsonp([16],{"wi+G":function(e,t){},"z+f2":function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=a("Xxa5"),r=a.n(n),l=a("exGp"),s=a.n(l),i=a("7L0k"),o=a("2BUL"),c=a("VvTn"),u={data:function(){return{searchValue:"",loading:!1,settles:{},settleDtls:[],dateRange:[Object(o.a)(new Date),Object(o.a)(new Date)],currentPage:1,showDtlDialog:!1,pickerOptions:{shortcuts:[{text:"今天",onClick:function(e){var t=new Date,a=new Date;e.$emit("pick",[a,t])}},{text:"最近一周",onClick:function(e){var t=new Date,a=new Date;a.setTime(a.getTime()-6048e5),e.$emit("pick",[a,t])}},{text:"最近一个月",onClick:function(e){var t=new Date,a=new Date;a.setTime(a.getTime()-2592e6),e.$emit("pick",[a,t])}}]}}},watch:{currentPage:function(){this.query()},searchValue:_.debounce(function(){this.query()},500),dateRange:_.debounce(function(){this.query()},500)},computed:{tableHeight:function(){return window.innerHeight-160}},methods:{toPage:function(e){this.currentPage=e},query:function(){var e=this;return s()(r.a.mark(function t(){var a;return r.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,e.loading=!0,t.next=4,Object(i.c)(e.searchValue,e.dateRange[0],e.dateRange[1],e.currentPage-1);case 4:a=t.sent,e.settles=a.object;case 6:return t.prev=6,e.loading=!1,t.finish(6);case 9:case"end":return t.stop()}},t,e,[[0,,6,9]])}))()},showDtl:function(e){var t=this;return s()(r.a.mark(function a(){var n;return r.a.wrap(function(a){for(;;)switch(a.prev=a.next){case 0:return a.prev=0,t.showDtlDialog=!0,t.loading=!0,t.settleDtls=[],a.next=6,Object(i.k)(e.id);case 6:n=a.sent,t.settleDtls=n.object;case 8:return a.prev=8,t.loading=!1,a.finish(8);case 11:case"end":return a.stop()}},a,t,[[0,,8,11]])}))()},getSummaries:function(e){var t=[],a=e.columns,n=e.data;return a.forEach(function(e,a){if(0!==a){var r=n.map(function(t){return Number(t[e.property])});3===a&&(t[a]=r.reduce(function(e,t){return Object(c.a)(e,t)},0),t[a]+=" 元")}else t[a]="合计"}),t}}},d={render:function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{directives:[{name:"loading",rawName:"v-loading",value:e.loading,expression:"loading"}],staticClass:"settle-record"},[a("navbar",{on:{back:function(t){e.$router.back()}}},[a("div",{staticClass:"title"},[e._v("结算记录")])]),e._v(" "),a("div",{staticClass:"container"},[a("el-row",[a("el-col",{attrs:{span:6,offset:2}},[a("sy-input",{ref:"searchInput",staticClass:"search-value",attrs:{prefix:"",suffix:e.searchValue.length>0,placeholder:"收银员代码/名称"},on:{prefix:e.query},model:{value:e.searchValue,callback:function(t){e.searchValue=t},expression:"searchValue"}})],1),e._v(" "),a("el-col",{attrs:{span:8,offset:1}},[a("el-date-picker",{attrs:{type:"daterange",align:"right","unlink-panels":"","range-separator":"至","start-placeholder":"开始日期","end-placeholder":"结束日期","value-format":"yyyy-MM-dd","picker-options":e.pickerOptions,clearable:!1,editable:!1},model:{value:e.dateRange,callback:function(t){e.dateRange=t},expression:"dateRange"}})],1)],1),e._v(" "),a("el-row",[a("el-col",{attrs:{span:22,offset:1}},[a("el-table",{attrs:{data:e.settles.content,stripe:"","highlight-current-row":"",height:e.tableHeight,"show-summary":"","summary-method":e.getSummaries}},[a("el-table-column",{attrs:{prop:"creDate",label:"创建时间"}}),e._v(" "),a("el-table-column",{attrs:{label:"结算时间段",width:"320px"},scopedSlots:e._u([{key:"default",fn:function(t){return[e._v("\n                        "+e._s(t.row.beginDate)),a("span",{staticStyle:{color:"red","font-weight":"bold"}},[e._v(" -- ")]),e._v(e._s(t.row.endDate)+"\n                    ")]}}])}),e._v(" "),a("el-table-column",{attrs:{label:"收银员"},scopedSlots:e._u([{key:"default",fn:function(t){return[e._v("\n                        ("+e._s(t.row.code)+") "+e._s(t.row.name)+"\n                    ")]}}])}),e._v(" "),a("el-table-column",{attrs:{align:"right",prop:"amount",label:"金额"}}),e._v(" "),a("el-table-column",{attrs:{label:"查看明细",align:"center"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("el-button",{attrs:{type:"primary",icon:"el-icon-tickets",circle:""},nativeOn:{click:function(a){a.preventDefault(),e.showDtl(t.row)}}})]}}])})],1)],1)],1),e._v(" "),a("el-row",{attrs:{type:"flex",justify:"center"}},[a("el-pagination",{staticClass:"mt-2",attrs:{background:"",layout:"total, prev, pager, next",pageCount:e.settles.totalPages,total:e.settles.totalElements,pageSize:e.settles.size,currentPage:e.currentPage},on:{currentChange:e.toPage,"update:currentPage":function(t){e.currentPage=t}}})],1)],1),e._v(" "),a("el-dialog",{staticClass:"query-settle-dtl-dialog",attrs:{title:"结算明细",visible:e.showDtlDialog,"append-to-body":!0,width:"30%"},on:{"update:visible":function(t){e.showDtlDialog=t}}},[a("div",[a("el-table",{attrs:{data:e.settleDtls,stripe:"","highlight-current-row":"",height:"60vh"}},[a("el-table-column",{attrs:{prop:"name",label:"支付方式"}}),e._v(" "),a("el-table-column",{attrs:{prop:"amount",align:"right",label:"金额"}})],1)],1)])],1)},staticRenderFns:[]};var p=a("VU/8")(u,d,!1,function(e){a("wi+G")},"data-v-77ac8822",null);t.default=p.exports}});