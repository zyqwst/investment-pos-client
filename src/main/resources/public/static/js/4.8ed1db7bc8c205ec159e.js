webpackJsonp([4],{"3P2H":function(a,e,t){"use strict";e.b=function(){return n.a.get("/package")},e.a=function(a){return n.a.get("/package/"+a)},e.c=function(a){return n.a.post("/sale/package",a)};var n=t("jYxq")},LZF7:function(a,e,t){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var n=t("Xxa5"),c=t.n(n),s=t("exGp"),r=t.n(s),i=t("Dd8w"),o=t.n(i),u=t("YN6D"),m=t("FB77"),p=t("NYxO"),l=t("VvTn"),d=t("lHQf"),g=t("3P2H"),f={data:function(){return{input:null,amount:1e6,pos:0,cash:0,card:0,commitDisabled:!1,packageItem:{qty:0},loading:!1}},components:{Calculator:u.a,CashType:m.a,MemberBar:d.a},computed:o()({},Object(p.b)(["member","isVip","isScan","isProtocalVip","curSaleMan"])),mounted:function(){this.findOne(this.$route.params.packageId)},deactivated:function(){this.$destroy()},watch:{"packageItem.qty":function(){this.amount=Object(l.b)(this.packageItem.qty,this.packageItem.amount)}},methods:{back:function(){this.$router.back()},focus:function(a){this.input=a},posChange:function(a){this.pos=a},cashChange:function(a){this.cash=a},cardChange:function(a){this.card=a},findOne:function(a){var e=this;return r()(c.a.mark(function t(){var n;return c.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,e.loading=!0,t.next=4,Object(g.a)(a);case 4:n=t.sent,e.packageItem=o()({},e.packageItem,n.object),e.packageItem.qty=1,e.amount=Object(l.b)(e.packageItem.qty,e.packageItem.amount);case 8:return t.prev=8,e.loading=!1,t.finish(8);case 11:case"end":return t.stop()}},t,e,[[0,,8,11]])}))()},confirm:function(){var a=this;return r()(c.a.mark(function e(){var t;return c.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(!(a.packageItem.qty<1)){e.next=3;break}return a.$message({type:"warning",message:"购买份数不得少于1份"}),e.abrupt("return");case 3:if(!(a.pos+a.cash+a.card<a.amount)){e.next=6;break}return a.$message({type:"warning",message:"支付金额不足"}),e.abrupt("return");case 6:return a.commitDisabled=!0,t={memberId:a.member.id,posAmount:a.pos,cashAmount:a.cash,cardAmount:a.card,saleManId:a.curSaleMan.id,count:a.packageItem.qty,packageId:a.packageItem.id},e.prev=8,e.next=11,Object(g.c)(t);case 11:e.sent,a.$message("购买成功"),a.$router.back();case 14:return e.prev=14,a.commitDisabled=!1,e.finish(14);case 17:case"end":return e.stop()}},e,a,[[8,,14,17]])}))()}}},h={render:function(){var a=this,e=a.$createElement,t=a._self._c||e;return t("div",{directives:[{name:"loading",rawName:"v-loading",value:a.loading,expression:"loading"}],staticClass:"cashier-package"},[t("navbar",{on:{back:a.back}},[t("div",{staticClass:"title"},[a._v("收银台")])]),a._v(" "),t("member-bar",{attrs:{member:a.member}}),a._v(" "),t("div",{staticClass:"tequan"},[t("el-row",[t("el-col",{staticStyle:{"min-width":"400px","padding-right":"1rem"},attrs:{span:10}},[t("el-form",{ref:"form",staticClass:"form",attrs:{width:"300px","label-width":"100px"}},[t("el-form-item",{attrs:{label:"已选特权:"}},[a._v("\n                        "+a._s(a.packageItem.name)+"\n                    ")]),a._v(" "),t("el-form-item",{attrs:{label:"价格:"}},[a._v("\n                        "+a._s(a._f("RMB")(a.packageItem.amount))+"\n                    ")]),a._v(" "),t("el-form-item",{attrs:{label:"购买份数:"}},[t("el-input",{attrs:{autofocus:""},on:{focus:function(e){a.input=e.target}},model:{value:a.packageItem.qty,callback:function(e){a.$set(a.packageItem,"qty",e)},expression:"packageItem.qty"}})],1)],1)],1)],1)],1),a._v(" "),t("div",{staticClass:"container"},[t("cash-type",{attrs:{amount:a.amount,showCard:a.isVip&&a.isScan},on:{focus:a.focus,cashChange:a.cashChange,posChange:a.posChange,cardChange:a.cardChange}}),a._v(" "),t("calculator",{staticClass:"calc",attrs:{input:a.input,disabled:a.commitDisabled,loading:a.commitDisabled},on:{enter:a.confirm}})],1)],1)},staticRenderFns:[]};var b=t("VU/8")(f,h,!1,function(a){t("h/Ii"),t("jyag")},"data-v-4167523c",null);e.default=b.exports},"h/Ii":function(a,e){},jyag:function(a,e){}});